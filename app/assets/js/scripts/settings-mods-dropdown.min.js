// settings-mods-dropdown.min.js â€” Minimal Add-on (dropdown only)
(() => {
  const NS = 'AZA_MODS_DROPDOWN_ONLY';

  const $  = (sel, root = document) => root.querySelector(sel);

  function bindOnce() {
    const root = $('#settingsModsContainer');
    if (!root || root.dataset[NS]) return;
    root.dataset[NS] = '1';

    const headers = root.querySelectorAll('.settingsModsHeader');
    headers.forEach(header => {
      header.setAttribute('role', 'button');
      header.setAttribute('tabindex', '0');
      const toggle = () => {
        const section = header.closest(
          '#settingsReqModsContainer, #settingsOptModsContainer, #settingsDropinModsContainer, #settingsShadersContainer'
        ) || header.parentElement;
        if (!section) return;
        section.toggleAttribute('collapsed');

        // Fallback if CSS missing:
        const content = section.querySelector('#settingsReqModsContent, #settingsOptModsContent, #settingsDropinModsContent, #settingsShadersContent, .settingsModsContent');
        if (content) content.style.display = section.hasAttribute('collapsed') ? 'none' : '';
      };
      header.addEventListener('click', toggle);
      header.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle(); }
      });
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', bindOnce, { once: true });
  } else {
    bindOnce();
  }

  // Observe for when the Mods tab is rendered/switched in Helios
  const obs = new MutationObserver(() => bindOnce());
  obs.observe(document.documentElement, { childList: true, subtree: true });
})();
